{% extends 'base.html' %}

{% block title %}Child Case Records{% endblock title %}
{% block page %}Birth Records{% endblock page %}

{% block body %}
    <div class="row gx-4">
        <div class="col-sm-12">
            <div class="card">
                <div class="card-header d-flex align-items-center justify-content-between">
                    <h5 class="card-title">Child Case Records</h5>
                    <a href="/admin/records/add-birth" class="btn btn-primary ms-auto">Add New Case</a>
                    <button type="button" class="btn btn-warning ms-1" data-bs-toggle="modal"
                            data-bs-target="#restoreRecordsModal">
                        <i class="ri-refresh-line"></i> View & Restore Deleted Records
                    </button>
                </div>
                <div class="card-body">
                    {% with messages = get_flashed_messages(with_categories=true) %}
                        {% if messages %}
                            {% for category, message in messages %}
                                <div class="alert alert-{{ category }} alert-dismissible fade show" id="flash-message">
                                    {{ message }}
                                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                                </div>
                            {% endfor %}
                        {% endif %}
                    {% endwith %}
                    <div class="table-responsive">
                        <table id="scrollVertical" class="table m-0 align-middle">
                            <thead>
                            <tr>
                                <th>Case #</th>
                                <th>Child Name</th>
                                <th>Gender</th>
                                <th>Birth Date</th>
                                <th>Parents</th>
                                <th>Contact</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for case in cases %}
                                <tr data-bs-toggle="modal"
                                    data-bs-target="#viewCaseModal{{ case.id }}"
                                    data-bs-placement="top" data-bs-title="View Details">
                                    <td>{{ case.case_number }}</td>
                                    <td>
                                        <strong>{{ case.first_name }} {{ case.last_name }}</strong>
                                        <div class="text-muted small">{{ case.address }}</div>
                                    </td>
                                    <td>
                                        {% if case.gender == 'Female' %}
                                            <span class="badge bg-pink bg-opacity-10 text-pink">Female</span>
                                        {% else %}
                                            <span class="badge bg-primary bg-opacity-10 text-primary">Male</span>
                                        {% endif %}
                                    </td>
                                    <td>
                                        {{ case.birth_date.strftime('%m/%d/%Y') if case.birth_date else 'N/A' }}<br>
                                    </td>
                                    <td>
                                        <div class="d-flex flex-column">
                                            <span>{{ case.mother_name }}</span>
                                            <span class="text-muted small">{{ case.father_name }}</span>
                                        </div>
                                    </td>
                                    <td>
                                        <i class="ri-phone-line align-middle"></i> {{ case.contact_number }}
                                    </td>
                                    <td>
                                        {% if case.status == 'Active' %}
                                            <span class="badge bg-success bg-opacity-10 text-success">Active</span>
                                        {% elif case.status == 'Follow-up Needed' %}
                                            <span class="badge bg-warning bg-opacity-10 text-warning">Follow-up Needed</span>
                                        {% else %}
                                            <span class="badge bg-secondary bg-opacity-10 text-secondary">{{ case.status }}</span>
                                        {% endif %}
                                    </td>
                                    <td>
                                        <div class="d-inline-flex gap-1">
                                            <button class="btn btn-outline-danger btn-sm" data-bs-toggle="modal"
                                                    data-bs-target="#deleteCaseModal{{ case.id }}">
                                                <i class="ri-delete-bin-line"></i>
                                            </button>
                                            <button class="btn btn-outline-success btn-sm"
                                                    data-bs-toggle="modal"
                                                    data-bs-target="#editCaseModal{{ case.id }}"
                                                    data-bs-placement="top" data-bs-title="Edit Case">
                                                <i class="ri-edit-box-line"></i>
                                            </button>
                                            <button class="btn btn-outline-info btn-sm"
                                                    data-bs-toggle="modal"
                                                    data-bs-target="#viewCaseModal{{ case.id }}"
                                                    data-bs-placement="top" data-bs-title="View Details">
                                                <i class="ri-eye-line"></i>
                                            </button>
                                            <a href="/admin/child-cases/{{ case.id }}/certificate"
                                               class="btn btn-outline-primary btn-sm"
                                               data-bs-toggle="tooltip"
                                               data-bs-placement="top" data-bs-title="Print Certificate">
                                                <i class="ri-printer-line"></i>
                                            </a>
                                        </div>
                                    </td>
                                </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals for each case -->
    {% for case in cases %}
        <!-- Delete Modal -->
        <div class="modal fade" id="deleteCaseModal{{ case.id }}" tabindex="-1"
             aria-labelledby="deleteCaseModalLabel{{ case.id }}" aria-hidden="true">
            <div class="modal-dialog modal-sm">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="deleteCaseModalLabel{{ case.id }}">Confirm Deletion</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        Are you sure you want to delete <b>{{ case.first_name }}'s</b> case record?
                    </div>
                    <div class="modal-footer">
                        <form action="/admin/records/birth-delete/{{ case.id }}" method="POST">
                            <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel
                            </button>
                            <button type="submit" class="btn btn-danger">Delete</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Edit Case Modal -->
        <div class="modal fade" id="editCaseModal{{ case.id }}" tabindex="-1"
             aria-labelledby="editCaseModalLabel{{ case.id }}" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="editCaseModalLabel{{ case.id }}">Edit
                            Case: {{ case.first_name }} {{ case.last_name }}</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <form method="POST" action="/admin/records/birth-edit/{{ case.id }}">

                        <div class="modal-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Case Number</label>
                                        <input type="text" class="form-control" value="{{ case.case_number }}" readonly>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">First Name</label>
                                        <input type="text" class="form-control" name="first_name"
                                               value="{{ case.first_name }}" required>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Last Name</label>
                                        <input type="text" class="form-control" name="last_name"
                                               value="{{ case.last_name }}" required>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Gender</label>
                                        <select class="form-select" name="gender" required>
                                            <option value="Male" {% if case.gender == 'Male' %}selected{% endif %}>
                                                Male
                                            </option>
                                            <option value="Female" {% if case.gender == 'Female' %}selected{% endif %}>
                                                Female
                                            </option>
                                        </select>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Birth Date</label>
                                        <input type="date" class="form-control" name="birth_date"
                                               value="{{ case.birth_date.strftime('%Y-%m-%d') if case.birth_date else '' }}"
                                               required>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Mother's Name</label>
                                        <input type="text" class="form-control" name="mother_name"
                                               value="{{ case.mother_name }}" required>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Father's Name</label>
                                        <input type="text" class="form-control" name="father_name"
                                               value="{{ case.father_name }}" required>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Contact Number</label>
                                        <input type="tel" class="form-control" name="contact_number"
                                               value="{{ case.contact_number }}" required>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Status</label>
                                        <select class="form-select" name="status">
                                            <option value="Active" {% if case.status == 'Active' %}selected{% endif %}>
                                                Active
                                            </option>
                                            <option value="Follow-up Needed"
                                                    {% if case.status == 'Follow-up Needed' %}selected{% endif %}>
                                                Follow-up Needed
                                            </option>
                                            <option value="Inactive"
                                                    {% if case.status == 'Inactive' %}selected{% endif %}>Inactive
                                            </option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-12">
                                    <div class="mb-3">
                                        <label class="form-label">Address</label>
                                        <textarea class="form-control" name="address" rows="2"
                                                  required>{{ case.address }}</textarea>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Case Notes</label>
                                        <textarea class="form-control" name="case_notes"
                                                  rows="3">{{ case.case_notes }}</textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                            <button type="submit" class="btn btn-primary">Save Changes</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- View Details Modal -->
        <div class="modal fade" id="viewCaseModal{{ case.id }}" tabindex="-1"
             aria-labelledby="viewCaseModalLabel{{ case.id }}"
             aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="viewCaseModalLabel{{ case.id }}">Child Case
                            : {{ case.first_name }} {{ case.last_name }}</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h6>Child Information</h6>
                                <p><strong>Case Number:</strong> {{ case.case_number }}</p>
                                <p><strong>Child Name:</strong> {{ case.first_name }} {{ case.last_name }}</p>
                                <p><strong>Gender:</strong> {{ case.gender }}</p>
                                <p><strong>Birth Date:</strong>
                                    {{ case.birth_date.strftime('%m/%d/%Y') if case.birth_date else 'N/A' }}
                                </p>
                                <p><strong>Address:</strong> {{ case.address }}</p>
                            </div>
                            <div class="col-md-6">
                                <h6>Parent Information</h6>
                                <p><strong>Mother's Name:</strong> {{ case.mother_name }}</p>
                                <p><strong>Father's Name:</strong> {{ case.father_name }}</p>
                                <p><strong>Contact Number:</strong> {{ case.contact_number }}</p>
                                <p><strong>Status:</strong>
                                    {% if case.status == 'Active' %}
                                        <span class="badge bg-success">Active</span>
                                    {% elif case.status == 'Follow-up Needed' %}
                                        <span class="badge bg-warning">Follow-up Needed</span>
                                    {% else %}
                                        <span class="badge bg-secondary">{{ case.status }}</span>
                                    {% endif %}
                                </p>
                            </div>
                        </div>
                        <div class="row mt-3">
                            <div class="col-12">
                                <h6>Case Notes</h6>
                                <div class="card bg-light">
                                    <div class="card-body">
                                        <p class="mb-0">{{ case.case_notes or 'No case notes available' }}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% if case.medical_visits %}
                            <div class="row mt-3">
                                <div class="col-12">
                                    <h6>Medical History</h6>
                                    <div class="table-responsive">
                                        <table class="table table-sm">
                                            <thead>
                                            <tr>
                                                <th>Date</th>
                                                <th>Visit Type</th>
                                                <th>Height</th>
                                                <th>Weight</th>
                                                <th>Notes</th>
                                                <th>Doctor</th>
                                                <th>Actions</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            {% for visit in case.medical_visits %}
                                                <tr>
                                                    <td>{{ visit.visit_date.strftime('%Y-%m-%d') }}</td>
                                                    <td>{{ visit.visit_type }}</td>
                                                    <td>{{ visit.height or 'N/A' }}</td>
                                                    <td>{{ visit.weight or 'N/A' }}</td>
                                                    <td>{{ visit.notes or 'N/A' }}</td>
                                                    <td>{{ visit.doctor.first_name if visit.doctor else 'N/A' }}</td>
                                                    <td>
                                                        <button class="btn btn-sm btn-outline-primary"
                                                                data-bs-toggle="modal"
                                                                data-bs-target="#editMedicalVisitModal{{ visit.id }}">
                                                            Edit
                                                        </button>
                                                        <button class="btn btn-outline-danger btn-sm"
                                                                data-bs-toggle="modal"
                                                                data-bs-target="#deleteCaseMedicalVisitModal{{ visit.id }}">
                                                            <i class="ri-delete-bin-line"></i>
                                                        </button>
                                                    </td>
                                                </tr>
                                            {% endfor %}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button class="btn btn-outline-success btn-sm"
                                data-bs-toggle="modal"
                                data-bs-target="#addMedicalVisitModal{{ case.id }}"
                                data-bs-placement="top" data-bs-title="Edit Case">
                            <i class="ri-edit-box-line"> Add Medical Visit</i>
                        </button>
                        <a href="/admin/records/birth/{{ case.id }}/certificate" class="btn btn-primary">Print
                            Certificate</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add Medical Visit Modal -->
        <div class="modal fade" id="addMedicalVisitModal{{ case.id }}" tabindex="-1"
             aria-labelledby="addMedicalVisitModalLabel{{ case.id }}" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="addMedicalVisitModalLabel{{ case.id }}">Add Medical Visit
                            for {{ case.first_name }}</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <form method="POST" action="/admin/records/birth-visit/{{ case.id }}/add-visit">

                        <div class="modal-body">
                            <div class="mb-3">
                                <label class="form-label">Visit Date</label>
                                <input type="date" class="form-control" name="visit_date" required>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Visit Type</label>
                                <select class="form-select" name="visit_type" required>
                                    <option value="Well-child">Well-child Visit</option>
                                    <option value="Vaccination">Vaccination</option>
                                    <option value="Sick Visit">Sick Visit</option>
                                    <option value="Follow-up">Follow-up</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Doctor</label>
                                <select class="form-select" name="doctor_id">
                                    <option value="">-- Select Doctor --</option>
                                    {% for doctor in doctors %}
                                        <option value="{{ doctor.id }}">
                                            {{ doctor.first_name }} {{ doctor.last_name }}
                                            {% if doctor.qualification %}({{ doctor.qualification }}){% endif %}
                                        </option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Height (cm)</label>
                                    <input type="text" class="form-control" name="height" placeholder="e.g., 75.2">
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">Weight (kg)</label>
                                    <input type="text" class="form-control" name="weight" placeholder="e.g., 9.5">
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Notes</label>
                                <textarea class="form-control" name="notes" rows="3"></textarea>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                            <button type="submit" class="btn btn-primary">Add Visit</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        {% for visit in case.medical_visits %}
            <!--Medical Visit  Delete Modal -->
            <div class="modal fade" id="deleteCaseMedicalVisitModal{{ visit.id }}" tabindex="-1"
                 aria-labelledby="deleteCaseMedicalVisitModal{{ visit.id }}" aria-hidden="true">
                <div class="modal-dialog modal-sm">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="deleteCaseMedicalVisitModal{{ visit.id }}">-Medical Visit
                                Confirm Deletion</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            Are you sure you want to delete {{ visit.id }}'s case record?
                        </div>
                        <div class="modal-footer">
                            <form action="/admin/records/birth-visit-delete/{{ visit.id }}" method="POST">
                                <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel
                                </button>
                                <button type="submit" class="btn btn-danger">Delete</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Edit Medical Visit Modal -->
            <div class="modal fade" id="editMedicalVisitModal{{ visit.id }}" tabindex="-1"
                 aria-labelledby="editMedicalVisitModalLabel{{ visit.id }}" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="editMedicalVisitModalLabel{{ visit.id }}">Edit Medical
                                Visit</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <form method="POST" action="/admin/records/birth-visit/{{ visit.id }}/edit">

                            <div class="modal-body">
                                <div class="mb-3">
                                    <label class="form-label">Visit Date</label>
                                    <input type="date" class="form-control" name="visit_date"
                                           value="{{ visit.visit_date.strftime('%Y-%m-%d') if visit.visit_date else '' }}"
                                           required>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Visit Type</label>
                                    <select class="form-select" name="visit_type" required>
                                        <option value="Well-child"
                                                {% if visit.visit_type == 'Well-child' %}selected{% endif %}>Well-child
                                            Visit
                                        </option>
                                        <option value="Vaccination"
                                                {% if visit.visit_type == 'Vaccination' %}selected{% endif %}>
                                            Vaccination
                                        </option>
                                        <option value="Sick Visit"
                                                {% if visit.visit_type == 'Sick Visit' %}selected{% endif %}>Sick Visit
                                        </option>
                                        <option value="Follow-up"
                                                {% if visit.visit_type == 'Follow-up' %}selected{% endif %}>Follow-up
                                        </option>
                                        <option value="Other" {% if visit.visit_type == 'Other' %}selected{% endif %}>
                                            Other
                                        </option>
                                    </select>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Doctor</label>
                                    <select class="form-select" name="doctor_id">
                                        <option value="">-- Select Doctor --</option>
                                        {% for doctor in doctors %}
                                            <option value="{{ doctor.id }}"
                                                    {% if visit.doctor_id == doctor.id %}selected{% endif %}>
                                                {{ doctor.first_name }} {{ doctor.last_name }}
                                                {% if doctor.qualification %}({{ doctor.qualification }}){% endif %}
                                            </option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Height (cm)</label>
                                        <input type="text" class="form-control" name="height"
                                               value="{{ visit.height if visit.height else '' }}"
                                               placeholder="e.g., 75.2">
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label class="form-label">Weight (kg)</label>
                                        <input type="text" class="form-control" name="weight"
                                               value="{{ visit.weight if visit.weight else '' }}"
                                               placeholder="e.g., 9.5">
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Notes</label>
                                    <textarea class="form-control" name="notes"
                                              rows="3">{{ visit.notes if visit.notes else '' }}</textarea>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                <button type="submit" class="btn btn-primary">Save Changes</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        {% endfor %}
    {% endfor %}


    <!-- Restore Records Modal -->
    <div class="modal fade" id="restoreRecordsModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Restore Deleted Records</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"
                            aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <ul class="nav nav-tabs" id="restoreTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="child-cases-tab" data-bs-toggle="tab"
                                    data-bs-target="#child-cases" type="button" role="tab">
                                Child Cases ({{ deleted_child_cases|length }})
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="medical-visits-tab" data-bs-toggle="tab"
                                    data-bs-target="#medical-visits" type="button" role="tab">
                                Medical Visits ({{ deleted_medical_visits|length }})
                            </button>
                        </li>
                    </ul>

                    <div class="tab-content p-3 border border-top-0" id="restoreTabsContent">
                        <!-- Child Cases Tab -->
                        <div class="tab-pane fade show active" id="child-cases" role="tabpanel">
                            {% if deleted_child_cases %}
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                        <tr>
                                            <th>Case #</th>
                                            <th>Child Name</th>
                                            <th>Birth Date</th>
                                            <th>Deleted On</th>
                                            <th>Actions</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        {% for case in deleted_child_cases %}
                                            <tr>
                                                <td>{{ case.case_number }}</td>
                                                <td>{{ case.first_name }} {{ case.last_name }}</td>
                                                <td>{{ case.birth_date.strftime('%Y-%m-%d') if case.birth_date else 'N/A' }}</td>
                                                <td>{{ case.deleted_at.strftime('%Y-%m-%d %H:%M') if case.deleted_at else 'Unknown' }}</td>
                                                <td>
                                                    <form method="POST"
                                                          action="/admin/records/restore-birth/{{ case.id }}">
                                                        <button type="submit"
                                                                class="btn btn-sm btn-success">
                                                            <i class="ri-refresh-line"></i> Restore
                                                        </button>
                                                    </form>
                                                </td>
                                            </tr>
                                        {% endfor %}
                                        </tbody>
                                    </table>
                                </div>
                            {% else %}
                                <div class="alert alert-info">No deleted child cases found</div>
                            {% endif %}
                        </div>

                        <!-- Medical Visits Tab -->
                        <div class="tab-pane fade" id="medical-visits" role="tabpanel">
                            {% if deleted_medical_visits %}
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                        <tr>
                                            <th>Visit Date</th>
                                            <th>Child Case</th>
                                            <th>Visit Type</th>
                                            <th>Deleted On</th>
                                            <th>Actions</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        {% for visit in deleted_medical_visits %}
                                            <tr>
                                                <td>{{ visit.visit_date.strftime('%Y-%m-%d') if visit.visit_date else 'N/A' }}</td>
                                                <td>
                                                    {% if visit.child_case %}
                                                        {{ visit.child_case.first_name }}
                                                        {{ visit.child_case.last_name }}
                                                    {% else %}
                                                        [Case Deleted]
                                                    {% endif %}
                                                </td>
                                                <td>{{ visit.visit_type }}</td>
                                                <td>{{ visit.deleted_at.strftime('%Y-%m-%d %H:%M') if visit.deleted_at else 'Unknown' }}</td>
                                                <td>
                                                    <form method="POST"
                                                          action="/admin/records/restore-birth-visit/{{ visit.id }}">
                                                        <button type="submit"
                                                                class="btn btn-sm btn-success">
                                                            <i class="ri-refresh-line"></i> Restore
                                                        </button>
                                                    </form>
                                                </td>
                                            </tr>
                                        {% endfor %}
                                        </tbody>
                                    </table>
                                </div>
                            {% else %}
                                <div class="alert alert-info">No deleted medical visits found</div>
                            {% endif %}
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close
                    </button>
                </div>
            </div>
        </div>
    </div>

{% endblock body %}


{% block heardLink %}
    <!-- Data Tables -->
    <link rel="stylesheet" href="../../../static/assets/vendor/datatables/dataTables.bs5.css">
    <link rel="stylesheet" href="../../../static/assets/vendor/datatables/dataTables.bs5-custom.css">
    <link rel="stylesheet" href="../../../static/assets/vendor/datatables/buttons/dataTables.bs5-custom.css">
{% endblock %}

{% block footerLink %}
    <!-- Data Tables -->
    <script src="../../../static/assets/vendor/datatables/dataTables.min.js"></script>
    <script src="../../../static/assets/vendor/datatables/dataTables.bootstrap.min.js"></script>
    <script src="../../../static/assets/vendor/datatables/custom/custom-datatables.js"></script>


    <script>

    </script>

{% endblock footerLink %}